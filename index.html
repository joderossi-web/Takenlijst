<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Master Overzicht</title>

    <!-- Materialize CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />

    <!-- Material Icons -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <style>
      body {
        background-color: #fafafa;
        padding: 10px;
      }
      .card {
        border-radius: 12px;
      }
      .card .card-content {
        min-height: 120px;
      }
      .header {
        text-align: center;
        margin-top: 15px;
        margin-bottom: 25px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h5 class="header">Overzicht</h5>
      <div id="overview" class="row"></div>
    </div>

    <!-- Materialize JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <script>
      const API_URL =
        "https://script.google.com/macros/s/AKfycbwxPaOoQOKFevEitDGlihL2Qp1pRu_Djhj1LsIH4--AtDVno265bMRHmFezc9DF9FexFQ/exec";

      // Data ophalen uit de master spreadsheet (tabblad Overzicht)
      async function fetchOverview() {
        try {
          const res = await fetch(`${API_URL}?type=overzicht`);
          const data = await res.json();

          const container = document.getElementById("overview");
          container.innerHTML = "";

          if (data.length === 0) {
            container.innerHTML =
              "<p class='center-align grey-text'>Geen actieve onderdelen gevonden.</p>";
            return;
          }

          data.forEach((item) => {
            const icon = item.icoon || "folder";
            const name = item.naam || "Onbekend";
            const beschrijving = item.beschrijving || "";
            const type = item.type || "";
            const colorClass = "blue lighten-4";

            const card = document.createElement("div");
            card.className = "col s12 m6 l4";
            card.innerHTML = `
              <div class="card ${colorClass}">
                <div class="card-content">
                  <span class="card-title">
                    <i class="material-icons left">${icon}</i>${name}
                  </span>
                  <p>${beschrijving}</p>
                </div>
                <div class="card-action">
                  <a href="#" onclick="openSection('${type}')">Openen</a>
                </div>
              </div>
            `;
            container.appendChild(card);
          });
        } catch (err) {
          console.error("Fout bij laden:", err);
          document.getElementById("overview").innerHTML =
            "<p class='red-text center-align'>Kon gegevens niet laden.</p>";
        }
      }

      // Functie om door te linken (nu nog dummy, later dynamisch)
      function openSection(type) {
        if (type === "Activiteiten") {
          window.location.href = "activiteiten.html";
        } else if (type === "Financieel") {
          window.location.href = "financieel.html";
        } else if (type === "Commissies") {
          window.location.href = "commissies.html";
        } else if (type === "Vergaderingen") {
          window.location.href = "vergaderingen.html";
        } else {
          M.toast({ html: "Pagina niet beschikbaar", classes: "red" });
        }
      }

      // Laad overzicht bij opstart
      fetchOverview();
    </script>
  </body>
</html>
