<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Overzicht</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"/>
</head>
<body>
  <div class="container">
    <h3>Overzicht</h3>
    <div id="overzicht-container" class="row"></div>
  </div>

  <script>
  const API_URL = "https://script.google.com/macros/s/AKfycbw7vdNL-mtGsR8pthDwJI_s_6ItncNNOts4PDJ1gYxdSTiiVPmp3kAKKifEtjfDzWgDNQ/exec
";

  async function fetchOverzicht() {
    try {
      const res = await fetch(API_URL + "?type=overzicht");
      const data = await res.json();
      const container = document.getElementById("overzicht-container");
      container.innerHTML = "";

      data.overzicht.forEach(item=>{
        const card = document.createElement("div");
        card.className = "col s12 m6 l4";
        card.innerHTML = `
          <div class="card">
            <div class="card-content">
              <span class="card-title"><i class="material-icons left">${item["Kleur/Icoon"]}</i>${item["Naam"]}</span>
              <p>${item["Beschrijving"]}</p>
            </div>
            <div class="card-action">
              <a href="${item["Spreadsheet ID"] ? "taken.html?sheetId=" + item["Spreadsheet ID"] + "&tab=" + item["Tabbladnaam"] : "#"}" class="btn">Open</a>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    } catch (error) {
      console.error(error);
      document.getElementById("overzicht-container").innerHTML = "<p>Fout bij laden overzicht.</p>";
    }
  }

  document.addEventListener("DOMContentLoaded", fetchOverzicht);
  </script>
</body>
</html>
